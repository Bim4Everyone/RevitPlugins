<core:WpfUIPlatformWindow
    x:Class="RevitMarkPlacement.Views.ReportElementsWindow"
    xmlns:base="clr-namespace:dosymep.WPF.Views"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:core="clr-namespace:dosymep.WpfUI.Core"
    xmlns:me="clr-namespace:dosymep.WpfCore.MarkupExtensions;assembly=dosymep.WpfCore"
    xmlns:b="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:vms="clr-namespace:RevitMarkPlacement.ViewModels.ReportViewModels"
    xmlns:markupExtensions="clr-namespace:RevitMarkPlacement.MarkupExtensions"

    mc:Ignorable="d"
    WindowStartupLocation="CenterOwner"

    Title="{me:LocalizationSource ReportWindow.Title}"

    Width="800"
    Height="450"

    MinWidth="800"
    MinHeight="450"

    d:DataContext="{d:DesignInstance vms:ReportElementsViewModel, IsDesignTimeCreatable=False}">

    <b:Interaction.Triggers>
        <b:EventTrigger
            EventName="Loaded">
            <b:InvokeCommandAction
                Command="{Binding LoadViewCommand}" />
        </b:EventTrigger>
    </b:Interaction.Triggers>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <ui:TitleBar
            Grid.Row="0"
            Title="{me:LocalizationSource ReportWindow.Title}" />

        <ScrollViewer
            Grid.Row="1"
            Margin="8 0"
            VerticalScrollBarVisibility="Auto">
            <ItemsControl
                ItemsSource="{Binding ReportElements}">

                <ItemsControl.ItemTemplate>
                    <DataTemplate DataType="vms:ReportElementViewModel">
                        <ui:CardExpander
                            IsExpanded="True"
                            Icon="{ui:SymbolIcon Warning24}">

                            <ui:CardExpander.Header>
                                <Grid ToolTip="{Binding Description}">

                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="Auto" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="Auto" />
                                    </Grid.ColumnDefinitions>

                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto" />
                                        <RowDefinition Height="Auto" />
                                    </Grid.RowDefinitions>

                                    <ui:TextBlock
                                        Grid.Row="0"
                                        Grid.Column="1"
                                        Margin="0 0 8 0"
                                        Appearance="Primary"
                                        FontTypography="BodyStrong"
                                        Text="{Binding Title}" />

                                    <ui:TextBlock
                                        Grid.Row="1"
                                        Grid.Column="1"
                                        Margin="0 0 8 0"
                                        Appearance="Secondary"
                                        Text="{Binding Description}"
                                        ToolTip="{Binding Description}" />

                                    <StackPanel
                                        Grid.Row="0"
                                        Grid.Column="2"
                                        Grid.RowSpan="2"
                                        Orientation="Horizontal">

                                        <ui:TextBlock
                                            Margin="0 0 5 0"
                                            Appearance="Disabled"
                                            VerticalAlignment="Center"
                                            HorizontalAlignment="Right"
                                            Text="{Binding ReportLevel, Converter={markupExtensions:EnumToLocale}}" />

                                        <ui:TextBlock
                                            Margin="0 0 5 0"
                                            Appearance="Disabled"
                                            VerticalAlignment="Center"
                                            HorizontalAlignment="Right"
                                            Text="{Binding Messages.Count, StringFormat=({0})}" />
                                    </StackPanel>

                                </Grid>
                            </ui:CardExpander.Header>

                            <ui:ListView ItemsSource="{Binding Messages}" />

                        </ui:CardExpander>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>

            </ItemsControl>
        </ScrollViewer>

        <StackPanel
            Grid.Row="2"
            Orientation="Horizontal"
            HorizontalAlignment="Right">

            <ui:Button
                Margin="10"
                Width="80"
                Content="{me:LocalizationSource ReportWindow.ButtonCancel}"
                IsCancel="True"
                Click="ButtonCancel_Click" />
        </StackPanel>
    </Grid>
</core:WpfUIPlatformWindow>