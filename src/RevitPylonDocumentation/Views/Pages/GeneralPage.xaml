<core:WpfUIPlatformPage 
    x:Class="RevitPylonDocumentation.Views.Pages.GeneralPage"
    x:ClassModifier="internal"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    
    xmlns:core="clr-namespace:dosymep.WpfUI.Core"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:me="clr-namespace:dosymep.WpfCore.MarkupExtensions;assembly=dosymep.WpfCore"
      
    xmlns:vms="clr-namespace:RevitPylonDocumentation.ViewModels"
    xmlns:local="clr-namespace:RevitPylonDocumentation.Views.Pages"
    xmlns:views="clr-namespace:RevitPylonDocumentation.Views"
    xmlns:controls="clr-namespace:RevitPylonDocumentation.Views.Controls"
    
    mc:Ignorable="d"
    ScrollViewer.CanContentScroll="False"
    Title="GeneralPage"
    d:DesignHeight="700" d:DesignWidth="600"
    d:DataContext="{d:DesignInstance vms:MainViewModel, IsDesignTimeCreatable=False}" >
    <core:WpfUIPlatformPage.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary
                    Source="../CustomStyles.xaml" />
                <ResourceDictionary
                    Source="../TooltipsDictionary.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </core:WpfUIPlatformPage.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Border Name="Marks"
            Grid.RowSpan="3"
            Margin="15 15 7 10"
            Style="{StaticResource CustomBorder}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <ui:TextBlock
                    Grid.Row="0"
                    Margin="5"
                    HorizontalAlignment="Stretch"
                    FontSize="16"
                    Text="Выбор пилонов"
                    Style="{StaticResource CustomTextBlock}"/>

                <ui:TextBlock 
                    Grid.Row="1"
                    Margin="5"
                    HorizontalAlignment="Stretch"
                    Text="Комплект документации:"
                    Style="{StaticResource CustomTextBlock}"/>

                <Grid
                    Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <ComboBox
                        Grid.Column="0"
                        Margin="5"
                        ItemsSource="{Binding ProjectSections}"
                        SelectedItem="{Binding Path=SelectionSettings.SelectedProjectSection}">
                        <i:Interaction.Triggers>
                            <i:EventTrigger
                                EventName="SelectionChanged">
                                <i:InvokeCommandAction
                                    Command="{Binding GetHostMarksInGUICommand}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </ComboBox>

                    <ui:Button
                        x:Name="refHeightButton"
                        Grid.Column="1"
                        Margin="5"
                        VerticalAlignment="Stretch"
                        Content="Выбрать пилон"/>
                </Grid>

                <ui:TextBlock
                    Grid.Row="3"
                    Margin="5"
                    Text="Выберите марки пилонов для обработки:"
                    Style="{StaticResource CustomTextBlock}" />

                <Grid
                    Grid.Row="4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <ui:TextBox
                        Grid.Column="0"
                        Margin="5"
                        PlaceholderText="Поиск..."
                        Text="{Binding Path=HostsInfoFilter, UpdateSourceTrigger=PropertyChanged}" />

                    <ui:Button
                        Grid.Column="1"
                        Margin="5"
                        VerticalAlignment="Stretch"
                        Icon="{ui:SymbolIcon CheckboxChecked24}"
                        Command="{Binding Path=SelectAllHostsInfoInGUICommand}" />

                    <ui:Button
                        Grid.Column="2"
                        Margin="5"
                        VerticalAlignment="Stretch"
                        Icon="{ui:SymbolIcon CheckboxUnchecked24}"
                        Command="{Binding Path=UnselectAllHostsInfoInGUICommand}" />
                </Grid>

                <ui:ListView
                    x:Name="hostMarks"
                    Grid.Row="5"
                    Grid.Column="0"
                    Margin="5"
                    ItemsSource="{Binding Path=SelectedHostsInfoVM, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                    SelectionMode="Multiple">
                    <ui:ListView.ItemTemplate>
                        <DataTemplate>
                            <CheckBox
                                Content="{Binding Path=PylonKeyName}"
                                IsChecked="{Binding Path=IsCheck, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">
                            </CheckBox>
                        </DataTemplate>
                    </ui:ListView.ItemTemplate>
                </ui:ListView>
            </Grid>
        </Border>

        <Border Name="Toggles"
            Grid.Row="0"
            Grid.Column="1"
            Margin="7 15 15 7"
            Style="{StaticResource CustomBorder}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Grid
                    Grid.Row="0"
                    Grid.ColumnSpan="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <ui:TextBlock
                        Grid.Column="0"
                        Margin="5"
                        FontSize="16"
                        Text="Элементы листа"
                        Style="{StaticResource CustomTextBlock}" />

                    <ui:Button
                        Grid.Column="1"
                        Margin="5"
                        VerticalAlignment="Stretch"
                        MinHeight="{Binding ElementName=refHeightButton, Path=ActualHeight}"
                        Icon="{ui:SymbolIcon ToggleRight16}"
                        Command="{Binding Path=SelectAllFuncInGUICommand}" />
                    
                    <ui:Button
                        Grid.Column="2"
                        Margin="5"
                        VerticalAlignment="Stretch"
                        Icon="{ui:SymbolIcon ToggleLeft16}"
                        Command="{Binding Path=UnselectAllFuncInGUICommand}"/>
                </Grid>
                
                <Grid Name="FormworkToggles"
                    Grid.Row="1" 
                    Grid.Column="0"
                    Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <ui:TextBlock
                        Grid.Row="0"
                        Margin="5"
                        Text="Виды опалубки"
                        Style="{StaticResource CustomTextBlock}" />

                    <ui:ToggleSwitch
                        Grid.Row="1"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithGeneralView}"
                        Content="Основной"/>

                    <ui:ToggleSwitch
                        Grid.Row="2"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithGeneralPerpendicularView}"
                        Content="Боковой" />

                    <ui:ToggleSwitch
                        Grid.Row="3"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithTransverseViewFirst}"
                        Content="Поперечный 1" />

                    <ui:ToggleSwitch
                        Grid.Row="4"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithTransverseViewSecond}"
                        Content="Поперечный 2" />

                    <ui:ToggleSwitch
                        Grid.Row="5"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithTransverseViewThird}"
                        Content="Поперечный 3" />
                </Grid>
                
                <Grid Name="RebarToggles"
                    Grid.Row="1"
                    Grid.Column="1"
                    Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <ui:TextBlock
                        Grid.Row="0"
                        Margin="5"
                        Text="Виды армирования"
                        Style="{StaticResource CustomTextBlock}" />

                    <ui:ToggleSwitch
                        Grid.Row="1"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithGeneralRebarView}"
                        Content="Основной" />

                    <ui:ToggleSwitch
                        Grid.Row="2"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithGeneralPerpendicularRebarView}"
                        Content="Боковой" />

                    <ui:ToggleSwitch
                        Grid.Row="3"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithTransverseViewFirst}"
                        Content="Поперечный 1" />

                    <ui:ToggleSwitch
                        Grid.Row="4"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithTransverseViewSecond}"
                        Content="Поперечный 2" />

                    <ui:ToggleSwitch
                        Grid.Row="5"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithTransverseViewThird}"
                        Content="Поперечный 3" />
                </Grid>
                
                <Grid Name="SpecToggles"
                    Grid.Row="2"
                    Grid.Column="0"
                    Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <ui:TextBlock
                        Grid.Row="0"
                        Margin="5"
                        Text="Виды спецификаций"
                        Style="{StaticResource CustomTextBlock}" />

                    <ui:ToggleSwitch
                        Grid.Row="1"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithSkeletonSchedule}"
                        Content="Каркас" />

                    <ui:ToggleSwitch
                        Grid.Row="2"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithSkeletonByElemsSchedule}"
                        Content="Елементы каркаса" />

                    <ui:ToggleSwitch
                        Grid.Row="3"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithMaterialSchedule}"
                        Content="Материалы" />

                    <ui:ToggleSwitch
                        Grid.Row="4"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithSystemPartsSchedule}"
                        Content="Системные детали" />

                    <ui:ToggleSwitch
                        Grid.Row="5"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithIfcPartsSchedule}"
                        Content="IFC детали" />
                </Grid>

                <Grid Name="OtherToggles"
                    Grid.Row="2"
                    Grid.Column="1"
                    Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <ui:TextBlock
                        Grid.Row="0"
                        Margin="5"
                        Text="Другие виды"
                        Style="{StaticResource CustomTextBlock}" />

                    <ui:ToggleSwitch
                        Grid.Row="1"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithLegend}"
                        Content="Легенда примечания" />
                </Grid>
            </Grid>
        </Border>

        <Border Name="SheetProps"
            Grid.Row="1"
            Grid.Column="1"
            Margin="7 7 15 7"
            Style="{StaticResource CustomBorder}">
            <StackPanel>
                <controls:SettingsTitleControl
                    LabelText="Лист"
                    ToolTipText="Параметры листа"
                    ButtonCommand="{Binding ApplySettingsCommand}"
                    ButtonMouseLeaveCommand="{Binding CheckSettingsCommand}" />

                <controls:ComboBoxSettingControl
                    Grid.Row="2"
                    LabelText="Выберите типоразмер рамки листа:"
                    ItemsSource="{Binding TitleBlocks}"
                    SelectedItem="{Binding TypesSettings.SelectedTitleBlock}"
                    ToolTipText="Выберите типоразмер рамки листа"
                    SelectionChangedCommand="{Binding SettingsChangedCommand}"
                    ItemTemplate="{StaticResource WithFamilyNameItemTemplate}"/>
            </StackPanel>
        </Border>

        <Border Name="ViewTemplates"
            Grid.Row="2"
            Grid.Column="1"
            Margin="7 7 15 10"
            Style="{StaticResource CustomBorder}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <StackPanel
                    Name="FormworkTemplates"
                    Grid.Row="1"
                    Grid.Column="0"
                    Margin="5">

                    <ui:TextBlock
                        Margin="5"
                        FontSize="16"
                        Text="Шаблоны видов опалубки"
                        Style="{StaticResource CustomTextBlock}" />

                    <controls:ComboBoxSettingControl
                        LabelText="Вертикальных видов"
                        ItemsSource="{Binding ViewTemplatesInPj}"
                        SelectedItem="{Binding TypesSettings.SelectedGeneralViewTemplate}"
                        SelectionChangedCommand="{Binding SettingsChangedCommand}"
                        ItemTemplate="{StaticResource WithoutFamilyNameItemTemplate}" />

                    <controls:ComboBoxSettingControl
                        LabelText="Горизонтальных видов"
                        ItemsSource="{Binding ViewTemplatesInPj}"
                        SelectedItem="{Binding TypesSettings.SelectedTransverseViewTemplate}"
                        SelectionChangedCommand="{Binding SettingsChangedCommand}"
                        ItemTemplate="{StaticResource WithoutFamilyNameItemTemplate}" />
                </StackPanel>

                <StackPanel
                    Name="RebarTemplates"
                    Grid.Row="1"
                    Grid.Column="1"
                    Margin="5">

                    <controls:SettingsTitleControl
                        LabelText="Шаблоны видов армирования"
                        ToolTipText="Шаблоны видов армирования"
                        ButtonCommand="{Binding ApplySettingsCommand}"
                        ButtonMouseLeaveCommand="{Binding CheckSettingsCommand}" />

                    <controls:ComboBoxSettingControl
                        Grid.Row="2"
                        Grid.Column="1"
                        LabelText="Вертикальных видов"
                        ItemsSource="{Binding ViewTemplatesInPj}"
                        SelectedItem="{Binding TypesSettings.SelectedGeneralRebarViewTemplate}"
                        SelectionChangedCommand="{Binding SettingsChangedCommand}"
                        ItemTemplate="{StaticResource WithoutFamilyNameItemTemplate}" />

                    <controls:ComboBoxSettingControl
                        Grid.Row="3"
                        Grid.Column="1"
                        LabelText="Горизонтальных видов"
                        ItemsSource="{Binding ViewTemplatesInPj}"
                        SelectedItem="{Binding TypesSettings.SelectedTransverseRebarViewTemplate}"
                        SelectionChangedCommand="{Binding SettingsChangedCommand}"
                        ItemTemplate="{StaticResource WithoutFamilyNameItemTemplate}" />
                </StackPanel>
            </Grid>
        </Border>

        <StackPanel
            Grid.Row="3"
            Grid.ColumnSpan="2"
            Orientation="Horizontal"
            HorizontalAlignment="Right">
            <TextBlock
                Margin="10 5 10 15"
                Foreground="Orange"
                VerticalAlignment="Center"
                Text="{Binding ErrorText}" />

            <ui:Button
                Margin="10 5 10 15"
                MinWidth="150"
                Content="Ок"
                Appearance="Info"
                Command="{Binding AcceptViewCommand}"
                Click="ButtonOk_Click" />

            <ui:Button
                Margin="10 5 15 15"
                MinWidth="150"
                Content="Отмена"
                Click="ButtonCancel_Click" />
        </StackPanel>
    </Grid>
</core:WpfUIPlatformPage>
