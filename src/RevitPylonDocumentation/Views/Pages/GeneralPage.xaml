<core:WpfUIPlatformPage 
    x:Class="RevitPylonDocumentation.Views.Pages.GeneralPage"
    x:ClassModifier="internal"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    
    xmlns:core="clr-namespace:dosymep.WpfUI.Core"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:me="clr-namespace:dosymep.WpfCore.MarkupExtensions;assembly=dosymep.WpfCore"
      
    xmlns:vms="clr-namespace:RevitPylonDocumentation.ViewModels"
    xmlns:local="clr-namespace:RevitPylonDocumentation.Views.Pages"
    xmlns:views="clr-namespace:RevitPylonDocumentation.Views"
    xmlns:controls="clr-namespace:RevitPylonDocumentation.Views.Controls"
    
    mc:Ignorable="d"
    ScrollViewer.CanContentScroll="False"
    Title="GeneralPage"
    d:DesignHeight="700" d:DesignWidth="900"
    d:DataContext="{d:DesignInstance vms:MainViewModel, IsDesignTimeCreatable=False}" >
    <core:WpfUIPlatformPage.Resources>
        <ResourceDictionary>
            <ResourceDictionary.MergedDictionaries>
                <ResourceDictionary
                    Source="../CustomStyles.xaml" />
                <ResourceDictionary
                    Source="../TooltipsDictionary.xaml" />
            </ResourceDictionary.MergedDictionaries>
        </ResourceDictionary>
    </core:WpfUIPlatformPage.Resources>

    <Grid>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="*" />
            <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>
        <Grid.RowDefinitions>
            <RowDefinition Height="*" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
        </Grid.RowDefinitions>

        <Border Name="Marks"
            Grid.RowSpan="3"
            Margin="15 15 7 10"
            Style="{StaticResource CustomBorder}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <ui:TextBlock
                    Grid.Row="0"
                    Margin="5"
                    HorizontalAlignment="Stretch"
                    FontSize="16"
                    Text="{me:LocalizationSource GeneralPage.PylonSelection}"
                    Style="{StaticResource CustomTextBlock}"/>

                <ui:TextBlock 
                    Grid.Row="1"
                    Margin="5"
                    HorizontalAlignment="Stretch"
                    Text="{me:LocalizationSource GeneralPage.DocumentationSet}"
                    Style="{StaticResource CustomTextBlock}"/>

                <Grid
                    Grid.Row="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <ComboBox
                        Grid.Column="0"
                        Margin="5"
                        ItemsSource="{Binding ProjectSections}"
                        SelectedItem="{Binding Path=SelectionSettings.SelectedProjectSection}"
                        ToolTip="Выберите комплект документации, с пилонами которого желаете поработать. Если вы хотите поработать с каким то конкретным пилоном, то нажмите кнопку справа &quot;Выбрать пилон&quot;.&#10;После этого выберите в списке ниже нужные марки пилонов, и в списке справа виды/спецификации, которые хотите создать/разместить. Затем нажмите &quot;Ок&quot;&#10;Если в списке ничего не отображается или внизу окна написана ошибка оранжевым текстом - отредактируйте &quot;Настройки&quot; в правом верхем углу.">
                        <i:Interaction.Triggers>
                            <i:EventTrigger
                                EventName="SelectionChanged">
                                <i:InvokeCommandAction
                                    Command="{Binding GetHostMarksInGUICommand}" />
                            </i:EventTrigger>
                        </i:Interaction.Triggers>
                    </ComboBox>

                    <ui:Button
                        x:Name="refHeightButton"
                        Grid.Column="1"
                        Margin="5"
                        VerticalAlignment="Stretch"
                        Content="{me:LocalizationSource GeneralPage.SelectPylon}"
                        ToolTip="Чтобы выбрать какой то конкретный пилон вручную:&#10;1) нажмите эту кнопку;&#10;2) окно плагина закроется и вам будет предоставлена возможность выбора элемента - кликните на нужный пилон;&#10;3) окно плагина снова откроется и вы сможете продолжить настройки."/>
                </Grid>

                <ui:TextBlock
                    Grid.Row="3"
                    Margin="5"
                    Text="{me:LocalizationSource GeneralPage.SelectPylonMarks}"
                    Style="{StaticResource CustomTextBlock}" />

                <Grid
                    Grid.Row="4">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>

                    <ui:TextBox
                        Grid.Column="0"
                        Margin="5"
                        PlaceholderText="{me:LocalizationSource GeneralPage.SearchPlaceholder}"
                        Text="{Binding Path=HostsInfoFilter, UpdateSourceTrigger=PropertyChanged}" 
                        ToolTip="Введите текст для поиска в списке ниже"/>

                    <ui:Button
                        Grid.Column="1"
                        Margin="5"
                        VerticalAlignment="Stretch"
                        Icon="{ui:SymbolIcon CheckboxChecked24}"
                        Command="{Binding Path=SelectAllHostsInfoInGUICommand}" 
                        ToolTip="Нажмите, чтобы выбрать все марки пилонов, видимые в списке ниже"/>

                    <ui:Button
                        Grid.Column="2"
                        Margin="5"
                        VerticalAlignment="Stretch"
                        Icon="{ui:SymbolIcon CheckboxUnchecked24}"
                        Command="{Binding Path=UnselectAllHostsInfoInGUICommand}" 
                        ToolTip="Нажмите, чтобы отменить выбор всех марок пилонов, видимых в списке ниже"/>
                </Grid>

                <ui:ListView
                    x:Name="hostMarks"
                    Grid.Row="5"
                    Grid.Column="0"
                    Margin="5"
                    ItemsSource="{Binding Path=SelectedHostsInfoVM, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                    SelectionMode="Multiple">
                    <ui:ListView.ItemTemplate>
                        <DataTemplate>
                            <CheckBox
                                Content="{Binding Path=PylonKeyName}"
                                IsChecked="{Binding Path=IsCheck, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}">
                            </CheckBox>
                        </DataTemplate>
                    </ui:ListView.ItemTemplate>
                </ui:ListView>
            </Grid>
        </Border>

        <Border Name="Toggles"
            Grid.Row="0"
            Grid.Column="1"
            Margin="7 15 15 7"
            Style="{StaticResource CustomBorder}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <Grid
                    Grid.Row="0"
                    Grid.ColumnSpan="2">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>

                    <ui:TextBlock
                        Grid.Column="0"
                        Margin="5"
                        FontSize="16"
                        Text="{me:LocalizationSource GeneralPage.SheetElements}"
                        Style="{StaticResource CustomTextBlock}" />

                    <ui:Button
                        Grid.Column="1"
                        Margin="5"
                        VerticalAlignment="Stretch"
                        MinHeight="{Binding ElementName=refHeightButton, Path=ActualHeight}"
                        Icon="{ui:SymbolIcon ToggleRight16}"
                        Command="{Binding Path=SelectAllFuncInGUICommand}" 
                        ToolTip="Нажмите, чтобы передвинуть тумблеры вправо у всех видов/спецификаций ниже"/>

                    <ui:Button
                        Grid.Column="2"
                        Margin="5"
                        VerticalAlignment="Stretch"
                        Icon="{ui:SymbolIcon ToggleLeft16}"
                        Command="{Binding Path=UnselectAllFuncInGUICommand}"
                        ToolTip="Нажмите, чтобы передвинуть тумблеры влево у всех видов/спецификаций ниже"/>
                </Grid>

                <Grid Name="FormworkToggles"
                    Grid.Row="1" 
                    Grid.Column="0"
                    Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <ui:TextBlock
                        Grid.Row="0"
                        Margin="5"
                        Text="{me:LocalizationSource GeneralPage.FormworkViews}"
                        Style="{StaticResource CustomTextBlock}" />

                    <ui:ToggleSwitch
                        Grid.Row="1"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithGeneralView}"
                        Content="{me:LocalizationSource GeneralPage.Main}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин создал и разместил на листах у выбранных пилонов основной вид пилона (вертикальный вид, который смотрит на большую сторону пилона)"/>

                    <ui:ToggleSwitch
                        Grid.Row="2"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithGeneralPerpendicularView}"
                        Content="{me:LocalizationSource GeneralPage.Side}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин создал и разместил на листах у выбранных пилонов боковой вид пилона (вертикальный вид, который смотрит на меньшую сторону пилона)"/>

                    <ui:ToggleSwitch
                        Grid.Row="3"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithTransverseViewFirst}"
                        Content="{me:LocalizationSource GeneralPage.Transverse1}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин создал и разместил на листах у выбранных пилонов поперечный разрез на уровне 1/4 высоты пилона"/>

                    <ui:ToggleSwitch
                        Grid.Row="4"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithTransverseViewSecond}"
                        Content="{me:LocalizationSource GeneralPage.Transverse2}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин создал и разместил на листах у выбранных пилонов поперечный разрез на уровне 1/2 высоты пилона"/>

                    <ui:ToggleSwitch
                        Grid.Row="5"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithTransverseViewThird}"
                        Content="{me:LocalizationSource GeneralPage.Transverse3}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин создал и разместил на листах у выбранных пилонов поперечный разрез на уровне на 5/4 высоты пилона"/>
                </Grid>

                <Grid Name="RebarToggles"
                    Grid.Row="1"
                    Grid.Column="1"
                    Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <ui:TextBlock
                        Grid.Row="0"
                        Margin="5"
                        Text="{me:LocalizationSource GeneralPage.RebarViews}"
                        Style="{StaticResource CustomTextBlock}" />

                    <ui:ToggleSwitch
                        Grid.Row="1"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithGeneralRebarView}"
                        Content="{me:LocalizationSource GeneralPage.Main}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин создал и разместил на листах у выбранных пилонов основной вид каркаса"/>

                    <ui:ToggleSwitch
                        Grid.Row="2"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithGeneralPerpendicularRebarView}"
                        Content="{me:LocalizationSource GeneralPage.Side}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин создал и разместил на листах у выбранных пилонов боковой вид каркаса"/>

                    <ui:ToggleSwitch
                        Grid.Row="3"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithTransverseViewFirst}"
                        Content="{me:LocalizationSource GeneralPage.Transverse1}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин создал и разместил на листах у выбранных пилонов первый поперечный разрез каркаса"/>

                    <ui:ToggleSwitch
                        Grid.Row="4"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithTransverseViewSecond}"
                        Content="{me:LocalizationSource GeneralPage.Transverse2}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин создал и разместил на листах у выбранных пилонов второй поперечный разрез каркаса"/>

                    <ui:ToggleSwitch
                        Grid.Row="5"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithTransverseViewThird}"
                        Content="{me:LocalizationSource GeneralPage.Transverse3}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин создал и разместил на листах у выбранных пилонов третий поперечный разрез каркаса"/>
                </Grid>

                <Grid Name="SpecToggles"
                    Grid.Row="2"
                    Grid.Column="0"
                    Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <ui:TextBlock
                        Grid.Row="0"
                        Margin="5"
                        Text="{me:LocalizationSource GeneralPage.ScheduleViews}"
                        Style="{StaticResource CustomTextBlock}" />

                    <ui:ToggleSwitch
                        Grid.Row="1"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithSkeletonSchedule}"
                        Content="{me:LocalizationSource GeneralPage.Skeleton}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин создал и разместил на листах у выбранных пилонов общую спецификацию каркаса"/>

                    <ui:ToggleSwitch
                        Grid.Row="2"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithSkeletonByElemsSchedule}"
                        Content="{me:LocalizationSource GeneralPage.SkeletonElements}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин создал и разместил на листах у выбранных пилонов поэлементную спецификацию каркаса"/>

                    <ui:ToggleSwitch
                        Grid.Row="3"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithMaterialSchedule}"
                        Content="{me:LocalizationSource GeneralPage.Materials}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин создал и разместил на листах у выбранных пилонов спецификацию материалов"/>

                    <ui:ToggleSwitch
                        Grid.Row="4"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithSystemPartsSchedule}"
                        Content="{me:LocalizationSource GeneralPage.SystemParts}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин создал и разместил на листах у выбранных пилонов ведомость системной арматуры"/>

                    <ui:ToggleSwitch
                        Grid.Row="5"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithIfcPartsSchedule}"
                        Content="{me:LocalizationSource GeneralPage.IfcParts}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин создал и разместил на листах у выбранных пилонов ведомость IFC арматуры"/>
                </Grid>

                <Grid Name="OtherToggles"
                    Grid.Row="2"
                    Grid.Column="1"
                    Margin="5">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                        <RowDefinition Height="*" />
                    </Grid.RowDefinitions>

                    <ui:TextBlock
                        Grid.Row="0"
                        Margin="5"
                        Text="{me:LocalizationSource GeneralPage.OtherViews}"
                        Style="{StaticResource CustomTextBlock}" />

                    <ui:ToggleSwitch
                        Grid.Row="1"
                        Margin="5"
                        IsChecked="{Binding Path=SelectionSettings.NeedWorkWithLegend}"
                        Content="{me:LocalizationSource GeneralPage.NotesLegend}" 
                        ToolTip="Передвиньте тумблер вправо, если хотите, чтобы плагин разместил на листах у выбранных пилонов легенду примечания"/>
                </Grid>
            </Grid>
        </Border>

        <Border Name="SheetProps"
            Grid.Row="1"
            Grid.Column="1"
            Margin="7 7 15 7"
            Style="{StaticResource CustomBorder}">
            <StackPanel>
                <controls:SettingsTitleControl
                    LabelText="{me:LocalizationSource GeneralPage.Sheet}"
                    ToolTipText="{me:LocalizationSource GeneralPage.SheetParameters}"
                    ButtonCommand="{Binding ApplySettingsCommand}"
                    ButtonMouseLeaveCommand="{Binding CheckSettingsCommand}" />

                <controls:ComboBoxSettingControl
                    Grid.Row="2"
                    LabelText="{me:LocalizationSource GeneralPage.SelectTitleBlockType}"
                    ItemsSource="{Binding TitleBlocks}"
                    SelectedItem="{Binding TypesSettings.SelectedTitleBlock}"
                    ToolTipText="Типоразмер рамки (штампа), которая будет размещена на новых листах"
                    SelectionChangedCommand="{Binding SettingsChangedCommand}"
                    ItemTemplate="{StaticResource WithFamilyNameItemTemplate}"/>
            </StackPanel>
        </Border>

        <Border Name="ViewTemplates"
            Grid.Row="2"
            Grid.Column="1"
            Margin="7 7 15 10"
            Style="{StaticResource CustomBorder}">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>

                <StackPanel
                    Name="FormworkTemplates"
                    Grid.Row="1"
                    Grid.Column="0"
                    Margin="5">

                    <ui:TextBlock
                        Margin="5"
                        FontSize="16"
                        Text="{me:LocalizationSource GeneralPage.FormworkViewTemplates}"
                        Style="{StaticResource CustomTextBlock}" />

                    <controls:ComboBoxSettingControl
                        LabelText="{me:LocalizationSource GeneralPage.VerticalViews}"
                        ItemsSource="{Binding ViewTemplatesInPj}"
                        SelectedItem="{Binding TypesSettings.SelectedGeneralViewTemplate}"
                        ToolTipText="Шаблон вида, который необходимо применить к основному и боковому виду при их создании."
                        SelectionChangedCommand="{Binding SettingsChangedCommand}"
                        ItemTemplate="{StaticResource WithoutFamilyNameItemTemplate}" />

                    <controls:ComboBoxSettingControl
                        LabelText="{me:LocalizationSource GeneralPage.HorizontalViews}"
                        ItemsSource="{Binding ViewTemplatesInPj}"
                        SelectedItem="{Binding TypesSettings.SelectedTransverseViewTemplate}"
                        ToolTipText="Шаблон вида, который необходимо применить к горизонтальным видам при их создании."
                        SelectionChangedCommand="{Binding SettingsChangedCommand}"
                        ItemTemplate="{StaticResource WithoutFamilyNameItemTemplate}" />
                </StackPanel>

                <StackPanel
                    Name="RebarTemplates"
                    Grid.Row="1"
                    Grid.Column="1"
                    Margin="5">

                    <controls:SettingsTitleControl
                        LabelText="{me:LocalizationSource GeneralPage.RebarViewTemplates}"
                        ToolTipText="{me:LocalizationSource GeneralPage.RebarViewTemplatesTooltip}"
                        ButtonCommand="{Binding ApplySettingsCommand}"
                        ButtonMouseLeaveCommand="{Binding CheckSettingsCommand}" />

                    <controls:ComboBoxSettingControl
                        Grid.Row="2"
                        Grid.Column="1"
                        LabelText="{me:LocalizationSource GeneralPage.VerticalViews}"
                        ItemsSource="{Binding ViewTemplatesInPj}"
                        SelectedItem="{Binding TypesSettings.SelectedGeneralRebarViewTemplate}"
                        ToolTipText="Шаблон вида, который необходимо применить к основному и боковому виду армирования при их создании."
                        SelectionChangedCommand="{Binding SettingsChangedCommand}"
                        ItemTemplate="{StaticResource WithoutFamilyNameItemTemplate}" />

                    <controls:ComboBoxSettingControl
                        Grid.Row="3"
                        Grid.Column="1"
                        LabelText="{me:LocalizationSource GeneralPage.HorizontalViews}"
                        ItemsSource="{Binding ViewTemplatesInPj}"
                        SelectedItem="{Binding TypesSettings.SelectedTransverseRebarViewTemplate}"
                        ToolTipText="Шаблон вида, который необходимо применить к горизонтальным видам армирования при их создании."
                        SelectionChangedCommand="{Binding SettingsChangedCommand}"
                        ItemTemplate="{StaticResource WithoutFamilyNameItemTemplate}" />
                </StackPanel>
            </Grid>
        </Border>

        <controls:AppFooterControl
            Grid.Row="3"
            Grid.ColumnSpan="2"
            HorizontalAlignment="Right"
            ErrorText="{Binding ErrorText}"
            OkButtonText="{me:LocalizationSource GeneralPage.Run}"
            OkCommand="{Binding AcceptViewCommand}"
            CancelButtonText="{me:LocalizationSource GeneralPage.Cancel}"/>
    </Grid>
</core:WpfUIPlatformPage>