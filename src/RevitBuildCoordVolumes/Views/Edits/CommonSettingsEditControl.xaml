<UserControl 
    x:Class="RevitBuildCoordVolumes.Views.Edits.CommonSettingsEditControl"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:edits="clr-namespace:RevitBuildCoordVolumes.Views.Edits"
    xmlns:ui="http://schemas.lepo.co/wpfui/2022/xaml"
    xmlns:me="clr-namespace:dosymep.WpfCore.MarkupExtensions;assembly=dosymep.WpfCore"
    xmlns:converters="clr-namespace:dosymep.WpfCore.Converters;assembly=dosymep.WpfCore"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:vms="clr-namespace:RevitBuildCoordVolumes.ViewModels">

    <UserControl.Resources>
        <converters:BoolToVisibilityConverter
            x:Key="ParamWarningIconVisible"
            TrueValue="Visible"
            FalseValue="Collapsed" />
        <Style
            TargetType="ToolTip">
            <Setter
                Property="MaxWidth"
                Value="650" />
        </Style>
    </UserControl.Resources>

    <StackPanel>
        <edits:CustomEditControl
            Icon="{ui:SymbolIcon shapeSubtract24}"
            Header="{me:LocalizationSource CommonSettingsEditControl.TypeAlgorithm}"
            Description="{me:LocalizationSource CommonSettingsEditControl.TypeAlgorithmDescription}">

            <ComboBox
                ItemsSource="{Binding TypeAlgorithms}"
                SelectedValue="{Binding SelectedTypeAlgorithm}"
                DisplayMemberPath="Name" />
        </edits:CustomEditControl>

        <edits:CustomEditControl
            Icon="{ui:SymbolIcon grid24}"
            Header="{me:LocalizationSource CommonSettingsEditControl.TypeZones}"
            Description="{me:LocalizationSource CommonSettingsEditControl.TypeZonesDescription}">

            <ComboBox
                ItemsSource="{Binding TypeZones}"
                SelectedValue="{Binding SelectedTypeZone}"
                DisplayMemberPath="Name" />
        </edits:CustomEditControl>

        <edits:CustomGroupEditControl
            Icon="{ui:SymbolIcon clipboardTaskListLtr24}"
            Header="{me:LocalizationSource CommonSettingsEditControl.Params}"
            Description="{me:LocalizationSource CommonSettingsEditControl.ParamsDescription}"
            ExtraIconVisible="True">
            <edits:CustomGroupEditControl.ExtraIcon>
                <ui:SymbolIcon
                    Symbol="Warning24"
                    Foreground="OrangeRed"
                    FontSize="24"
                    ToolTip="{me:LocalizationSource CommonSettingsEditControl.ParamWarningTooltip}"
                    Visibility="{Binding HasParamWarning, Converter={StaticResource ParamWarningIconVisible}}" />
            </edits:CustomGroupEditControl.ExtraIcon>

            <edits:CustomGroupEditControl.EditControl>
                <ItemsControl
                    ItemsSource="{Binding Params}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate
                            DataType="{x:Type vms:ParamViewModel}">
                            <edits:ParamControl
                                Description="{Binding Description}"
                                DetailDescription="{Binding DetailDescription}"
                                SourceParamName="{Binding SourceParamName, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                TargetParamName="{Binding TargetParamName, UpdateSourceTrigger=PropertyChanged, Mode=TwoWay}"
                                IsChecked="{Binding IsChecked, Mode=TwoWay}"
                                HasSourceParam="{Binding HasSourceParam, Mode=TwoWay}"
                                HasTargetParam="{Binding HasTargetParam, Mode=TwoWay}"
                                HasWarning="{Binding HasWarning, Mode=TwoWay}"
                                WarningDescription="{Binding Warnings}" />
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>

                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </edits:CustomGroupEditControl.EditControl>
        </edits:CustomGroupEditControl>
    </StackPanel>

</UserControl>
